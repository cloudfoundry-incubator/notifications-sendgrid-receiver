#! /usr/bin/env bash
set -e -x

cf api api.10.244.0.34.xip.io --skip-ssl-validation
cf auth admin admin
cf create-org notifications
cf target -o notifications
cf create-space notifications
cf target -s notifications

cf push notifications-sendgrid-receiver --no-start

cf set-env notifications-sendgrid-receiver UAA_HOST https://uaa.10.244.0.34.xip.io
cf set-env notifications-sendgrid-receiver UAA_CLIENT_ID admin
cf set-env notifications-sendgrid-receiver UAA_CLIENT_SECRET admin-secret
cf set-env notifications-sendgrid-receiver CC_HOST https://api.10.244.0.34.xip.io
cf set-env notifications-sendgrid-receiver VERIFY_SSL false
cf set-env notifications-sendgrid-receiver PORT 3000

cf start notifications-sendgrid-receiver
